<html>
<head>
<meta charset="UTF-8" />
<title> js_common_code </title>
</head>
<body>
	
	<script>
		
		/**
		 * 함수의 인자를 왼쪽부터 한개씩 적용하여, 필요한 인자가 모두 채워지면 함수를 호출한다.
		 * @param {function} fn
		 * @param {object} a, b
		 * @returns {function} || {object}
		 */
		var _curry = fn => {
			return function(a, b){
				return arguments.length == 2 ? fn(a, b) : function(b){return fn(a, b);};
			}
		}

		/**
		 * 함수의 인자를 오른쪽부터 한개씩 적용하여, 필요한 인자가 모두 채워지면 함수를 호출한다.
		 * @param {function} fn
		 * @param {object} a, b
		 * @returns {function} || {object}
		 */
		var _curryr = fn => {
			return function(a, b){
				return arguments.length == 2 ? fn(b, a) : function(b){return fn(b, a);};
			}
		}

		/**
	         * 지정된 객체 자체의 열거 가능한 문자속성 [key, value] 쌍의 배열 중 [value] 가 반환된다.
	         * @param {object} obj
	         * @param {object} key
	         * @returns {object}
	         */
	        var _get = (obj, key) => !!!obj ? undefined : obj[key];
		_get = _curryr(_get);
		
		/**
		 * 지정된 객체 자체의 열거 가능한 문자속성 [key, value] 쌍의 배열 중 [key] 가 배열로 반환된다.
		 * @param {object} obj
	         * @returns [array]
	         */
		var _is_object = obj => typeof obj == "object" && !!obj;
		var _keys = obj => _is_object(obj) ? Object.keys(obj) : [];
		  
		/**
		 * 배열 또는 유사배열을 반복하여 함수를 호출한다.
		 * @param [array] || [arraylike] list
		 * @param {function} iter
		 * @returns [array]
		 */
		var _each = (list, iter) => {
			// var _length = _get('length');
			var keys = _keys(list);
			for (var i = 0, len = keys.length; i < len; i++) {
				iter(list[keys[i]]);
			}
			return list;
		}
		
		/**
		 * 배열 또는 유사배열을 조건에 따라 필터링한다.
		 * @param [array] || [arraylike] list
		 * @param {function} predi
		 * @returns [array]
		 */
		var _filter = (list, predi) => {
			var new_list = [];
			_each(list, val => {
				if(predi(val)) new_list.push(val);
			})
			return new_list;
		}

		/**
		 * 배열 또는 유사배열 내에 함수를 호출한 결과에 대한 각각의 요소를 반환한다.
		 * @param [array] || [arraylike] list
		 * @param {function} mapper
		 * @returns [array]
		 */
		var _map = (list, mapper) => {
			var new_list = [];
			_each(list, val => new_list.push(mapper(val)));
			return new_list;
		}
		
		/**
		 * 배열의 요소를 순차적으로 순회하면서 리듀서(iter) 함수를 호출하고 하나의 결과값을 반환한다.
		 * @param [array] list
		 * @param {function} iter
		 * @returns {object}
		 */
		function _reduce(list, iter, memo){
			if(arguments.length == 2){
				memo = list[0];
				list = _rest(list);
			}
			_each(list, val => memo = iter(memo, val));
			return memo;
		}

		/**
		 * 배열 또는 유사배열로부터 특정 범위까지의 값을 제외한 새로운 배열을 만든다.
		 * @param [array] list
		 * @param {int} num
		 * @returns [array]
		 */
		var _rest = (list, num) => {
			var slice = Array.prototype.slice;
			return slice.call(list, num || 1);
		}
		
		/**
		 * 인자로 들어온 N개의 함수를 연속적으로 실행하여 하나의 결과값을 반환한다.
		 * @param {object} arg
		 * @returns {object}
		 */
		var _pipe = (...fns) => arg => _reduce(fns, (fn, arg) => fn(arg), arg);
		
		/**
		 * 첫번째 인자를 N개의 함수의 인자로 지정하고, 연속적으로 실행하여 하나의 결과값을 반환한다.
		 * @param {object} arg
		 * @returns {function}
		 */
		var _go = (arg, ...fns) => _pipe.apply(null, fns)(arg);
		_filter = _curryr(_filter),
		_map = _curryr(_map);

	</script>

</body>
</html>
